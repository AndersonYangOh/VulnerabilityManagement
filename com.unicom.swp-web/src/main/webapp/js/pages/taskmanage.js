/**
	* @author wangjian
	* @date 2016/9/5.
	*/


var common = {
	//居中
	center: function(width, height, ele) {
		var pageWidth = window.top.innerWidth;
		var pageHeight = window.top.innerHeight;
		$(window.parent.document).find(ele).css({
			"left": (pageWidth - width) / 2,
			"top": (pageHeight - height) / 2,
			"display": "block"
		});
		$(window.parent.document).find(".ejectBg").show();
	},
	hide: function(ele){
		$(ele).hide();
		$(".ejectBg").hide();
	},
	taskId:0,
	queryInterval:undefined
};

$(function(){
	//var objId=getQueryString("groupId");
	var objId = $.cookie("clickId");
	//是否包含自动隶属的资产
	$.ajax({
		method: "GET",
		url: "../assetsAutoSelect/hasSelectedAssets.do",
		data: { fromGroupId: objId}
	}).done(function( response ) {
		if(response && response.code==0){
			if(response.content){
				var el= $("#moveAssets");
				el.attr("href", el.attr("href")+"?objId="+objId);
				el.show();
			}
		}
	}).fail(function(response){
		console.log(response.innerHTML);
	});
});

function queryTaskProgress(){
	$.ajax({
		method: "GET",
		url: "../utility/getuploadprogress.do",
		data: { taskId: common.taskId}
	}).done(function( response ) {
		if(response && response.code==0 ){
			var taskProgress = response.content.taskProgress;
			if(response.message.length>0) {
				var text = "待处理文件: " + taskProgress.fileCount + "个，当前文件进度: " + response.message+"(";
				if(taskProgress.percent==100) {
					text += "<span style='color:green'>"+taskProgress.percent+"%</span>";
				}else text += taskProgress.percent+"%";
				text+= ")";
				console.log(text);
				$("#progress").html(text);
			}
			//$("#refreshProgress").show();
			if(taskProgress.fileCount==0 && taskProgress.percent==100){
				clearInterval(common.queryInterval);
			}
		}
		else{
			$("#progress").text("");
			$("#refreshProgress").hide();
			clearInterval(common.queryInterval);
			console.log("no task running")
		}
	}).fail(function(response){
		console.log(response.innerHTML);
		clearInterval(common.queryInterval);
	});
}

function toUploadFile(gat_Id) {}
