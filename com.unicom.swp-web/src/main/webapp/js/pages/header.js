var webHelper={
    /*getPlatform:function(){
        return Cookies.get("platform")*1;
    },*/
    web:1,
    host:0,
    code:2,
    platform:0,
    platformChanged:false
};
$(function() {
	
    $("#webSwitch").click(function () {
        Cookies.set('platform', webHelper.web, {expires: 365});
        Cookies.set('platformChanged', true, {expires: 365})
        webHelper.platform = webHelper.web;
        webHelper.platformChanged = true;
        setRootId();
        location.reload();
    });
    $("#hostSwitch").click(function () {
        Cookies.set('platform', webHelper.host, {expires: 365});
        Cookies.set('platformChanged', true, {expires: 365})
        webHelper.platform = webHelper.host;
        webHelper.platformChanged = true;
        setRootId();
        location.reload();
    });

    if(!Cookies.get("platform")){       
	    $.ajax({						
        method: "GET",
        url: "/userManage/getDefaultPlatform.do",
        async: false
	    }).done(function (response) {
	        if (response && response.code == 0){	        	           	
	            if (response.content!=null){
	                Cookies.set("platform", response.content);
	                
	                if (response.content == webHelper.web) {
	                    $("#webSwitch").click();
	                }
	                else if (response.content == webHelper.code){
	                }else{
	                    $("#hostSwitch").click();
	                }
	            }
	        }
	    }).fail(function (response) {
	        console.log(response.innerHTML);
	    });
    }
    
    if (Cookies.get("platform") == webHelper.web) {
        $("#webSwitch").prop("checked", true);
        webHelper.platform = webHelper.web;
    }
    else if (Cookies.get("platform") == webHelper.code){
        $("#codeSwitch").prop("checked", true);
        webHelper.platform = webHelper.code;
    }else{
        $("#hostSwitch").prop("checked", true);
        webHelper.platform = webHelper.host;
    }


    if(jQuery.jgrid) {
        jQuery.extend(jQuery.jgrid.defaults, {
            rownumbers: true,
            rowNum: 50,
            rowList: [50, 100, 500],
            multiselect: false,
            sortable: true,
            loadonce: true,
            viewrecords: true,
            gridview: true,
            autoencode: true,
            autowidth: true,
            shrinkToFit: true,
            width: "1040"
        });
    }
});

	function setRootId(){
    $.ajax({
        method: "GET",
        dataType: "json",
        url: "/objectManage/getRootDTO.do",
        async:false
    }).done(function(msg) {
        if(msg.code==0){
            Cookies.set("clickId", msg.content.gatId);
            Cookies.set("clickType", msg.content.gatDatatype);
            Cookies.set("clickName", msg.content.gatName);
        }
    }).fail(function(msg){
        console.log(msg.message);
    });

}