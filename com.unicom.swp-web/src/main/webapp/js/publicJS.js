/*------------------------------ 公用javascript方法 ------------------------------*/
//引用示例：<script language="javascript" src="..\resources\js\publicJS.js"></script>

/*--------------- 数据格式验证专用 ---------------*/
/*----- 判断是否为正整数 -----*/
function isInt(v) {
	var regValue = /^[1-9]*[1-9][0-9]*$/;
	if (regValue.test(v))
		return true;
	else
		return false;
}
/*----- 判断是否为正整数 -----*/

/*----- 判断是否为数字 -----*/
function isNumber(v) {
	var regValue = /^[0-9]+$/;
	if (regValue.test(v))
		return true;
	else
		return false;
}
/*----- 判断是否为数字 -----*/

/*----- 判断是否为英文大小写的混合 -----*/
function isChar(v) {
	var regValue = /^[A-Za-z]+$/;
	if (regValue.test(v))
		return true;
	else
		return false;
}
/*----- 判断是否为英文大小写的混合 -----*/

/*----- 判断是否为汉字 -----*/
function isChineseChar(v) {
	var regValue = /^[\u4e00-\u9fa5]+$/;
	if (regValue.test(v))
		return true;
	else
		return false;
}
/*----- 判断是否为汉字 -----*/

/*----- 判断是否为英文大小写与数字的混合 -----*/
function isCharAndNumber(v) {
	var regValue = /^[A-Za-z0-9]+$/;
	if (regValue.test(v))
		return true;
	else
		return false;
}
/*----- 判断是否为英文大小写与数字的混合 -----*/

/*----- 判断是否为英文大小写与数字、汉字的混合 -----*/
function isString(v) {
	var regValue = /^[A-Za-z0-9\u4e00-\u9fa5]+$/;
	if (regValue.test(v))
		return true;
	else
		return false;
}
/*----- 判断是否为英文大小写与数字、汉字的混合 -----*/

/*----- 判断是否为电子邮件地址 -----*/
function isEmail(v) {
	var regValue = /\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/;
	if (regValue.test(v))
		return true;
	else
		return false;
}
/*----- 判断是否为电子邮件地址 -----*/
/*--------------- 数据格式验证专用 ---------------*/

/*--------------- 数据处理专用 ---------------*/
/*-- JSON数组排序专用--*/
/*--
 filed：排序的字段
 rev：false=正序，true=倒序
 primer：parseInt=整数，String=字符串
 --*/
function sortBy(filed, rev, primer) {
	rev = (rev) ? -1 : 1;
	return function (a, b) {
		a = a[filed];
		b = b[filed];
		if (typeof (primer) != 'undefined') {
			a = primer(a);
			b = primer(b);
		}
		if (a < b) {
			return rev * -1;
		}
		if (a > b) {
			return rev * 1;
		}

		return 1;
	}
};
/*-- JSON数组排序专用--*/
/*--------------- 数据处理专用 ---------------*/

/*--------------- 页面控件专用 ---------------*/
/*----- 设置下拉列表选中项 -----*/
function setSelected(optionsObj, values) {
	if (values != "" && values != null && values != undefined) {
		//var optionsObj = document.getElementById(id).options;
		//var optionsObj = document.forms[formIndex].name.options;

		var valuesArr = values.split(",");
		for (var i = 0; i < optionsObj.length; i++) {
			//alert(optionsObj[i].value + "--" + optionsObj[i].text);
			for (var y = 0; y < valuesArr.length; y++) {
				if (optionsObj[i].value == valuesArr[y]) {
					optionsObj[i].selected = true;
					break;
				}
			}
		}
	}
}
/*----- 设置下拉列表选中项 -----*/

/*----- 清除下拉列表选中项 -----*/
function clearSelected(optionsObj) {
	//var optionsObj = document.getElementById(id).options;
	//var optionsObj = document.forms[formIndex].name.options;
	for (var i = 0; i < optionsObj.length; i++) {
		optionsObj[i].selected = false;
	}
}
/*----- 清除下拉列表选中项 -----*/

/*----- 查询条件(下拉列表)是否变更 -----*/
function selectIsChange(optionsObj, values) {
	//var optionsObj = document.getElementById(id).options;
	//var optionsObj = document.forms[formIndex].name.options;
	var selectedValues = "";
	for (var i = 0; i < optionsObj.length; i++) {
		if (optionsObj[i].selected == true)
			selectedValues = selectedValues + optionsObj[i].value + ",";
	}
	selectedValues = selectedValues.substring(0, (selectedValues.length - 1));

	var optionsValuesArr;
	if (selectedValues != "" && selectedValues != null && selectedValues != undefined)
		optionsValuesArr = selectedValues.split(",");
	else
		optionsValuesArr = new Array(0);

	var valuesArr;
	if (values != "" && values != null && values != undefined)
		valuesArr = values.split(",");
	else
		valuesArr = new Array(0);

	var isChange = false; //是否变更
	if (valuesArr.length == optionsValuesArr.length) {
		//值的个数相等，继续判断
		for (var i = 0; i < valuesArr.length; i++) {
			var isMatch = false;
			for (var y = 0; y < optionsValuesArr.length; y++) {
				if (valuesArr[i] == optionsValuesArr[y]) {
					isMatch = true;
					break;
				}
			}

			if (isMatch == false) {
				isChange = true;
				break;
			}
		}
	}
	else //值的个数不等，已变更
	{
		isChange = true;
	}

	return isChange;
}
/*----- 查询条件(下拉列表)是否变更 -----*/

/*----- 取得下拉列表指定索引的值 -----*/
function getSelectIndexValue(options, index) {
	var retValue = "";
	var optLength = options.length - 1;
	if (isInt(index)) {
		if (index >= 0 && index <= optLength) //在列表长度之内
		{
			retValue = options[index].value;
		}
		else if (index < optLength) //小于列表长度
		{
			retValue = options[0].value;
		}
		else if (index > optLength) //大于列表长度
		{
			retValue = options[optLength].value;
		}
	}
	else {
		retValue = options[0].value;
	}

	return retValue;
}
/*----- 取得下拉列表指定索引的值 -----*/

/*----- 取得下拉列表指定索引的文本 -----*/
function getSelectIndexText(options, index) {
	var retText = "";
	var optLength = options.length - 1;
	if (isInt(index)) {
		if (index >= 0 && index <= optLength) //在列表长度之内
		{
			retText = options[index].text;
		}
		else if (index < optLength) //小于列表长度
		{
			retText = options[0].text;
		}
		else if (index > optLength) //大于列表长度
		{
			retText = options[optLength].text;
		}
	}
	else {
		retText = options[0].text;
	}

	return retText;
}
/*----- 取得下拉列表指定索引的文本 -----*/

/*----- 下拉列表选中的值转换为String类型的Where -----*/
//示例：==>'aaa', 'bbb', 'ccc'
function getSelectStringWhere(options) {
	var selectedCount = 0;
	for (var i = 0; i < options.length; i++) {
		if (options[i].selected == true) {
			selectedCount = selectedCount + 1;
		}
	}

	var retValue = "";
	for (var i = 0; i < options.length; i++) {
		if (options[i].selected == true) {
			selectedCount = selectedCount - 1;
			if (selectedCount == 0)
				retValue = retValue + "'" + options[i].value + "'";

			else
				retValue = retValue + "'" + options[i].value + "', ";
		}
	}
	return retValue;
}
/*----- 下拉列表选中的值转换为String类型的Where -----*/

/*----- 下拉列表选中的值转换为Int类型的Where -----*/
//示例：[1, 2, 3]==>1, 2, 3
function getSelectIntWhere(options) {
	var selectedCount = 0;
	for (var i = 0; i < options.length; i++) {
		if (options[i].selected == true) {
			selectedCount = selectedCount + 1;
		}
	}

	var retValue = "";
	for (var i = 0; i < options.length; i++) {
		if (options[i].selected == true) {
			selectedCount = selectedCount - 1;
			if (selectedCount == 0)
				retValue = retValue + options[i].value;

			else
				retValue = retValue + options[i].value + ", ";
		}
	}
	return retValue;
}
/*----- 下拉列表选中的值转换为Int类型的Where -----*/

/*----- 添加下拉列表的记录 -----*/
function addSelectOptions(optionsObj, optionsArr) {
	if (optionsArr != null && optionsArr.length > 0) {
		for (var i = 0; i < optionsArr.length; i++) {
			optionsObj.add(optionsArr[i]);
		}
	}
}
/*----- 添加下拉列表的记录 -----*/

/*----- 删除下拉列表的记录 -----*/
function removeSelectOptions(optionsObj) {
	if (optionsObj.length > 0) {
		for (var i = (optionsObj.length - 1); i >= 0; i--) {
			optionsObj.remove(i);
		}
	}
}
/*----- 删除下拉列表的记录 -----*/

/*----- 文本域输入的字数长度判断 -----*/
function checkTextLength(textareaObj, retMessage) {
	var max = textareaObj.maxLength;
	if (max != "" && max != null && max != undefined) {
		if (isInt(max)) {
			if (textareaObj.value.length >= max) {
				alert(retMessage + "的字数请不要超过最大长度：" + max);
				textareaObj.value = textareaObj.value.substr(0, (max));
				return;
			}
		}
	}
}
/*----- 文本域输入的字数长度判断 -----*/

/*----- 页面按钮禁用、启用方法 -----*/
/*--
 disabled = true //按钮禁用
 disabled = false //按钮启用
 --*/
function buttonDisabled(Form, buttonArr, disabled) {
	for (var i = 0; i < buttonArr.length; i++) {
		if (Form.elements[buttonArr[i]] != null) {
			Form.elements[buttonArr[i]].disabled = disabled;
		}
	}
}
/*----- 页面按钮禁用、启用方法 -----*/

/*-- 全选树形菜单--*/
function selectAll_Tree(treeName) {
	if ($(treeName).tree('getRoot') != null) {
		var rootNode = $(treeName).tree('getRoot');
		$(treeName).tree('check', rootNode.target); //全选
	}
}
/*-- 全选树形菜单--*/

/*-- 清除树形菜单--*/
function noSelectAll_Tree(treeName) {
	if ($(treeName).tree('getRoot') != null) {
		var rootNode = $(treeName).tree('getRoot');
		$(treeName).tree('uncheck', rootNode.target); //取消选择
	}
}
/*-- 清除树形菜单--*/

/*-- 获取树形菜单选中节点、未选中节点、不确定节点 --*/
/*--
 var nodes = $(name).tree('getChecked'); //获取选中节点
 var nodes = $(name).tree('getChecked', 'unchecked'); //获取未选中节点
 var nodes = $(name).tree('getChecked', 'indeterminate'); //获取不确定节点
 --*/
function getNodes_Tree(treeName, checkedType) {
	var nodes = [];
	if (checkedType != "" && checkedType != null && checkedType != undefined)
		nodes = $(treeName).tree('getChecked', checkedType);
	else
		nodes = $(treeName).tree('getChecked');

	return nodes;
}
/*-- 获取树形菜单选中节点、未选中节点、不确定节点 --*/

/*-- 设置树形菜单节点选中、未选中(基于树形菜单节点单击事件)--*/
function setChecked_Tree(node, treeName) {
	var noFound = true;
	var nodes = $(treeName).tree('getChecked', 'unchecked'); //获取未选中节点
	for (var i = 0; i < nodes.length; i++) {
		if (node.id == nodes[i].id) {
			$(treeName).tree('check', node.target); //选中
			noFound = false;
			break;
		}
	}

	if (noFound == true) {
		nodes = $(treeName).tree('getChecked'); //获取选中节点
		for (var i = 0; i < nodes.length; i++) {
			if (node.id == nodes[i].id) {
				$(treeName).tree('uncheck', node.target); //未选中
				noFound = false;
				break;
			}
		}

		if (noFound == true) {
			nodes = $(treeName).tree('getChecked', 'indeterminate'); //获取不确定节点
			for (var i = 0; i < nodes.length; i++) {
				if (node.id == nodes[i].id) {
					$(treeName).tree('check', node.target); //选中
					break;
				}
			}
		}
	}
}
/*-- 设置树形菜单节点选中、未选中(基于树形菜单节点单击事件)--*/
/*--------------- 页面控件专用 ---------------*/

/*--------------- 页面功能专用 ---------------*/
/*----- 设置分页+查询 -----*/
function setPageQry(Form, doing, pageNo_default, pageRecordNo_default) {
	if (check()) //查询条件验证
	{
		var resultsSize = Form.resultsSize.value; //页面的总记录数
		if (doing == "init" && resultsSize == 0) //首次查询，不考虑分页
		{
			Form.doing.value = "qry";
			Form.qryBut.disabled = true; //查询按钮禁用
			Form.resetBut.disabled = true; //重置按钮禁用
			Form.submit();
		}
		else {
			if (!checkQryChange()) //查询条件变更，分页设置为默认值
			{
				Form.pageNo.value = 1; //更新当前页数
				Form.pageRecordNo.value = 20; //更新当前页的记录数
				Form.sumRecordNo.value = 0; //更新总记录数
				Form.sumPageNo.value = 0; //更新总页数

				Form.doing.value = "qry";
				Form.qryBut.disabled = true; //查询按钮禁用
				Form.resetBut.disabled = true; //重置按钮禁用
				Form.submit();
			}
			else //查询条件无变更，分页继续计算
			{
				var sumRecordNo = Form.sumRecordNo.value; //总记录数
				sumRecordNo = parseInt(sumRecordNo);

				var sumPageNo = Form.sumPageNo.value; //总页数
				sumPageNo = parseInt(sumPageNo);

				var pageNo = Form.pageNo.value; //当前页数(用户在页面输入)
				var pageNo2 = parseInt(pageNo_default); //当前页数(默认)
				if (isInt(pageNo)) //判断是否为正整数
				{
					pageNo = parseInt(pageNo);
					if (pageNo < 1) //当前页数(用户在页面输入) < 1
					{
						//恢复当前页数(用户在页面输入) = 默认值
						pageNo = pageNo2;
						Form.pageNo.value = pageNo; //更新当前页数
					}
					if (pageNo > sumPageNo) //当前页数(用户在页面输入) > 总页数
					{
						//默认当前页数(用户在页面输入) = 总页数
						pageNo = sumPageNo;
						Form.pageNo.value = pageNo; //更新当前页数
					}
				}
				else //输入非法数据
				{
					//恢复当前页数(用户在页面输入) = 默认值
					pageNo = pageNo2;
					Form.pageNo.value = pageNo; //更新当前页数
				}

				var pageRecordNo = Form.pageRecordNo.value; //当前页的记录数(用户在页面输入)
				var pageRecordNo2 = parseInt(pageRecordNo_default); //当前页的记录数(默认)
				if (isInt(pageRecordNo)) //判断是否为正整数
				{
					pageRecordNo = parseInt(pageRecordNo);
					if (pageRecordNo < 1) //当前页的记录数(用户在页面输入) < 1
					{
						//恢复当前页数(用户在页面输入)、当前页的记录数(用户在页面输入) = 默认值
						pageNo = pageNo2;
						pageRecordNo = pageRecordNo2;
						Form.pageNo.value = pageNo; //更新当前页数
						Form.pageRecordNo.value = pageRecordNo; //更新当前页的记录数
					}

					if (pageRecordNo > sumRecordNo) //当前页的记录数(用户在页面输入) > 总记录数
					{
						//默认在一页中显示所有记录
						pageNo = 1;
						if (sumRecordNo < 20) //总记录数 < 20
							pageRecordNo = 20;
						else
							pageRecordNo = sumRecordNo;
						Form.pageNo.value = pageNo; //更新当前页数
						Form.pageRecordNo.value = pageRecordNo; //更新当前页的记录数
					}
				}
				else //输入非法数据
				{
					//恢复当前页数(用户在页面输入)、当前页的记录数(用户在页面输入) = 默认值
					pageNo = pageNo2;
					pageRecordNo = pageRecordNo2;
					Form.pageNo.value = pageNo; //更新当前页数
					Form.pageRecordNo.value = pageRecordNo; //更新当前页的记录数
				}

				if (pageRecordNo != pageRecordNo2) //用户更改了当前页的记录数，需要重新计算总页数！
				{
					sumPageNo = sumRecordNo / pageRecordNo; //总页数 = 总记录数/当前页的记录数(用户在页面输入)
					if (sumRecordNo % pageRecordNo != 0) {
						//如果不能整除，则舍去小数，取整数！
						var sumPageNoStr = sumPageNo.toString().substring(0, sumPageNo.toString().indexOf("."));
						sumPageNo = parseInt(sumPageNoStr) + 1;
					}
				}

				if (doing == "first") //首页
					pageNo = 1;

				if (doing == "upper") //上页
				{
					if ((pageNo - 1) < 1)
						pageNo = 1;
					else
						pageNo = pageNo - 1;
				}

				if (doing == "next") //下页
				{
					if ((pageNo + 1) > sumPageNo)
						pageNo = sumPageNo;
					else
						pageNo = pageNo + 1;
				}

				if (doing == "end") //末页
					pageNo = sumPageNo;

				Form.pageNo.value = pageNo; //更新当前页数

				Form.doing.value = "qry";
				Form.qryBut.disabled = true; //查询按钮禁用
				Form.resetBut.disabled = true; //重置按钮禁用
				Form.submit();
			}
		}
	}
}
/*----- 设置分页+查询 -----*/

/*----- 排序设置 -----*/
function orderBy(Form, orderByField, pageNo_default, pageRecordNo_default) {
	if (Form.orderByField.value != orderByField) {
		Form.orderByField.value = orderByField; //排序字段
		Form.orderByWay.value = "asc"; //排序方式=正序
	}
	else {
		if (Form.orderByWay.value == "asc") {
			Form.orderByWay.value = "desc"; //排序方式=倒序
		}
		else if (Form.orderByWay.value == "desc") {
			Form.orderByWay.value = "asc"; //排序方式=正序
		}
	}

	setPageQry(Form, 'init', pageNo_default, pageRecordNo_default); //查询以刷新页面
}
/*----- 排序设置 -----*/

/*----- 全选 -----*/
function selectAll(Form, buttonArr) {
	var resultsSize = Form.resultsSize.value; //页面的总记录数
	for (i = 0; i < resultsSize; i++) {
		if (Form.elements["item_" + i].checked == false) {
			dataTableMouseEvent(i, "over");
			Form.elements["item_" + i].checked = true;
		}
	}

	for (var i = 0; i < buttonArr.length; i++) {
		if (Form.elements[buttonArr[i]] != null) {
			if (buttonArr[i] == "selectAllBut")
				Form.elements[buttonArr[i]].disabled = true;
			else
				Form.elements[buttonArr[i]].disabled = false;
		}
	}
}
/*----- 全选 -----*/

/*----- 清除 -----*/
function noSelectAll(Form, buttonArr) {
	//var radioUpd = Form.radioUpd;
	var radioUpd = Form.elements[radioUpd];
	if (radioUpd != null) //单选按钮
	{
		if (radioUpd.length != ""
			&& radioUpd.length != null
			&& radioUpd.length != undefined) //有两条及以上记录
		{
			for (var i = 0; i < radioUpd.length; i++) {
				if (radioUpd[i].checked == true) {
					radioUpd[i].checked = false;
					dataTableMouseEvent(i, "out");
				}
			}
		}
		else if (radioUpd.checked) //只有一条记录
		{
			radioUpd.checked = false;
			dataTableMouseEvent(0, "out");
		}

		for (var i = 0; i < buttonArr.length; i++) {
			if (Form.elements[buttonArr[i]] != null)
				Form.elements[buttonArr[i]].disabled = true;
		}
	}
	else //复选框
	{
		var resultsSize = Form.resultsSize.value; //页面的总记录数
		for (i = 0; i < resultsSize; i++) {
			if (Form.elements["item_" + i].checked == true) {
				Form.elements["item_" + i].checked = false;
				dataTableMouseEvent(i, "out");
			}
		}

		for (var i = 0; i < buttonArr.length; i++) {
			if (Form.elements[buttonArr[i]] != null) {
				if (buttonArr[i] == "selectAllBut")
					Form.elements[buttonArr[i]].disabled = false;
				else
					Form.elements[buttonArr[i]].disabled = true;
			}
		}
	}
}
/*----- 清除 -----*/

/*----- 检查选中 -----*/
function selectCheck(Form, buttonArr) {
	var radioUpd = Form.elements["radioUpd"];
	if (radioUpd != null) //单选按钮
	{
		for (var i = 0; i < buttonArr.length; i++) {
			if (Form.elements[buttonArr[i]] != null)
				Form.elements[buttonArr[i]].disabled = true;
		}

		if (radioUpd.length != ""
			&& radioUpd.length != null
			&& radioUpd.length != undefined) //有两条及以上记录
		{
			for (var i = 0; i < radioUpd.length; i++) {
				if (radioUpd[i].checked == true) {
					for (var i = 0; i < buttonArr.length; i++) {
						if (Form.elements[buttonArr[i]] != null)
							Form.elements[buttonArr[i]].disabled = false;
					}
					break;
				}
			}
		}
		else if (radioUpd.checked) //只有一条记录
		{
			for (var i = 0; i < buttonArr.length; i++) {
				if (Form.elements[buttonArr[i]] != null)
					Form.elements[buttonArr[i]].disabled = false;
			}
		}
	}
	else //复选框
	{
		var allSelect_true = true;
		var allSelect_false = true;

		var resultsSize = Form.resultsSize.value; //页面的总记录数
		for (i = 0; i < resultsSize; i++) {
			if (Form.elements["item_" + i].checked == true)
				allSelect_false = false;
			if (Form.elements["item_" + i].checked == false)
				allSelect_true = false;
		}

		if (allSelect_true == false && allSelect_false == false) {
			for (var i = 0; i < buttonArr.length; i++) {
				if (Form.elements[buttonArr[i]] != null)
					Form.elements[buttonArr[i]].disabled = false;
			}
		}

		if (allSelect_true == true && allSelect_false == true) {
			for (var i = 0; i < buttonArr.length; i++) {
				if (Form.elements[buttonArr[i]] != null)
					Form.elements[buttonArr[i]].disabled = true;
			}
		}

		if (allSelect_true == false && allSelect_false == true) {
			for (var i = 0; i < buttonArr.length; i++) {
				if (Form.elements[buttonArr[i]] != null) {
					if (buttonArr[i] == "selectAllBut")
						Form.elements[buttonArr[i]].disabled = false;
					else
						Form.elements[buttonArr[i]].disabled = true;
				}
			}
		}

		if (allSelect_true == true && allSelect_false == false) {
			for (var i = 0; i < buttonArr.length; i++) {
				if (Form.elements[buttonArr[i]] != null) {
					if (buttonArr[i] == "selectAllBut")
						Form.elements[buttonArr[i]].disabled = true;
					else
						Form.elements[buttonArr[i]].disabled = false;
				}
			}
		}
	}
}
/*----- 检查选中 -----*/

/*----- 新建弹出窗口 -----*/
function getNewWindow(URL, height, width, top, left, toolbar, menubar, scrollbars, resizable, location, status) {
	/*--
	 window.open(URL, '', 'height=500, width=700, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no');
	 参数解释：
	 window.open 弹出新窗口的命令；
	 'page.html' 弹出窗口的文件名；
	 'newwindow' 弹出窗口的名字（不是文件名），非必须，可用空''代替；
	 height=100 窗口高度；
	 width=400 窗口宽度；
	 top=0 窗口距离屏幕上方的象素值；
	 left=0 窗口距离屏幕左侧的象素值；
	 toolbar=no 是否显示工具栏，yes为显示；
	 menubar，scrollbars 表示菜单栏和滚动栏。
	 resizable=no 是否允许改变窗口大小，yes为允许；
	 location=no 是否显示地址栏，yes为允许；
	 status=no 是否显示状态栏内的信息（通常是文件已经打开），yes为允许；
	 --*/
	newWin = window.open(URL, '', 'height=' + height + ', width=' + width + ', top=' + top + ', left=' + left + ', toolbar=' + toolbar + ', menubar=' + menubar + ', scrollbars=' + scrollbars + ', resizable=' + resizable + ', location=' + location + ', status=' + status + '');
	newWin.focus();
}
/*----- 新建弹出窗口 -----*/

/*----- 数据表格的变色处理 -----*/
function dataTableMouseEvent(index, type) //鼠标移动事件
{
	var itemObj = document.getElementById("item_" + index);
	if (itemObj != null) //有复选框或单选按钮
	{
		if (itemObj.checked == false) //未选中
		{
			if (type == "over") {
				document.getElementById("dataTr_" + index).style.backgroundColor = "#FFE4C4";
				document.getElementById("dataTr_" + index).style.color = "#FF0000";

				if (document.getElementById("href_" + index) != null)
					document.getElementById("href_" + index).style.color = "#FF0000";
			}
			else if (type == "out") {
				if (index % 2 == 0)
					document.getElementById("dataTr_" + index).style.backgroundColor = "#FFFFFF"; //偶数行
				else
					document.getElementById("dataTr_" + index).style.backgroundColor = "#DFEBF2"; //奇数行

				document.getElementById("dataTr_" + index).style.color = "#000000";

				if (document.getElementById("href_" + index) != null)
					document.getElementById("href_" + index).style.color = "#000000";
			}
		}
	}
	else {
		if (type == "over") {
			document.getElementById("dataTr_" + index).style.backgroundColor = "#FFE4C4";
			document.getElementById("dataTr_" + index).style.color = "#FF0000";

			if (document.getElementById("href_" + index) != null)
				document.getElementById("href_" + index).style.color = "#FF0000";
		}
		else if (type == "out") {
			if (index % 2 == 0)
				document.getElementById("dataTr_" + index).style.backgroundColor = "#FFFFFF"; //偶数行
			else
				document.getElementById("dataTr_" + index).style.backgroundColor = "#DFEBF2"; //奇数行

			document.getElementById("dataTr_" + index).style.color = "#000000";

			if (document.getElementById("href_" + index) != null)
				document.getElementById("href_" + index).style.color = "#000000";
		}
	}
}

function dataTableClickEvent(Form, index) //鼠标单击事件
{
	var radioUpd = Form.elements["radioUpd"];
	if (radioUpd != null) //单选按钮
	{
		var itemObj = document.getElementById("item_" + index);
		if (itemObj.checked == false) //未选中
		{
			itemObj.checked = true;
		}
		else //已选中
		{
			itemObj.checked = false;
		}

		if (radioUpd.length != ""
			&& radioUpd.length != null
			&& radioUpd.length != undefined) //有两条及以上记录
		{
			for (var i = 0; i < radioUpd.length; i++) {
				if (radioUpd[i].checked == false && i != index)
					dataTableMouseEvent(i, "out");
			}
		}
	}
	else //复选框
	{
		var itemObj = document.getElementById("item_" + index);
		if (itemObj.checked == false) //未选中
		{
			itemObj.checked = true;
		}
		else //已选中
		{
			itemObj.checked = false;
		}
	}

	selectCheck(Form, buttonArr); //检查选中
}
/*----- 数据表格的变色处理 -----*/

/*----- 禁用鼠标右键 -----*/
function disableRightKey(event) //禁用鼠标右键
{
	event.returnValue = false;
}
/*----- 禁用鼠标右键 -----*/

/*----- 键盘事件监听 -----*/
function disableKey(event) //键盘事件监听
{
	if ((event.keyCode == 8) //屏蔽退格删除键
		|| (event.ctrlKey && event.keyCode == 82) //屏蔽退格删除键 (Ctrl+R)
		|| (event.keyCode == 116)) //屏蔽 F5 刷新键
	{
		event.keyCode = 0;
		event.returnValue = false;
	}
}
/*----- 键盘事件监听 -----*/
/*--------------- 页面功能专用 ---------------*/

/*--------------- CKEditor编辑器专用 ---------------*/
/*----- CKEditor编辑器初始化方法 -----*/
function CKEditorInit(name, toolbarName) {
	//创建CKEditor实例，必须写在window.onload事件里
	//var editor = null;
	//editor = CKEDITOR.replace(name); //参数是textarea元素的name属性值，而非id属性值

	editor = CKEDITOR.replace(name,
		{
			toolbar: toolbarName
		});
	editor.setData('');
	//alert(editor.getData());
}

/*----- 获取HttpRequest请求 -----*/
function getHttpRequest() {
	var request = null;
	try {
		if (window.XMLHttpRequest) {
			request = new XMLHttpRequest();
		}
		else if (window.ActiveXObject) {
			request = new ActiveXObject("Msxml2.XMLHTTP");
			if (!request) {
				request = new ActiveXObject("Microsoft.XMLHTTP");
			}
		}
	}
	catch (e) {
		alert("Ajax获取HttpRequest请求失败！");
	}

	return request;
}

function sendHttpRequest(reqType, url, asynch, strArgs, retType) {
	var retValue = null;
	var request = getHttpRequest(); //获取HttpRequest请求
	if (request) {
		request.onreadystatechange = function () {
			if (request.readyState == 4) //请求已完成，且响应已就绪
			{
				if (request.status == 200) //OK
				{
					if (retType.toUpperCase() == "TEXT") //返回值类型(转化为大写字母)
					{
						retValue = request.responseText;
					}
					else if (retType.toUpperCase() == "XML") {
						retValue = request.responseXML;
					}
					else {
						retValue = request.responseText;
					}

					request = null;
				}
			}
		}

		request.open(reqType, url, asynch);
		if (reqType.toUpperCase() == "POST") //请求类型=POST(转化为大写字母)
		{
			request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=UTF-8");
			request.send(strArgs);
		}
		else //请求类型=GET
		{
			request.send(null);
		}
	}
	else {
		alert("您的浏览器不支持该应用程序的功能！");
	}

	return retValue;
}

$(function () {
	//此处加载层关闭
	layer.closeAll('loading');
});

/*----- 发送HttpRequest请求 -----*/
/*--------------- Ajax功能专用 ---------------*/

/*------------------------------ 公用javascript方法 ------------------------------*/

/**获取Url参数**/
function getQueryString(name) {
	var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
	var r = window.location.search.substr(1).match(reg);
	if (r != null)return decodeURIComponent(r[2]);
	return null;
}

function htmlEscape(str) {
	return str.replace(/&/g, '&amp;')
		.replace(/"/g, '&quot;')
		.replace(/'/g, '&#39;')
		.replace(/</g, '&lt;')
		.replace(/>/g, '&gt;');
}

// I needed the opposite function today, so adding here too:
function htmlUnescape(str) {
	return str.replace(/&quot;/g, '"')
		.replace(/&#39;/g, "'")
		.replace(/&lt;/g, '<')
		.replace(/&gt;/g, '>')
		.replace(/&amp;/g, '&');
}

var project={
	company: "中国联合网络通信有限公司研究院",
	systemName: "中国联通漏扫管控平台",
	copyright:"中国联合网络通信有限公司研究院",
	title:"中国联通漏扫管控平台"
}

$(document).attr("title",project.title);
$("#footer").text(project.copyright);


